{% extends 'base.html' %}
{% load static %}

{% block content_top %}
<div class="container py-5">
  <div class="row">

    <!-- KIRI: Gambar Produk -->
    <div class="col-md-4 text-center mb-4">
      {% if produk.gambar %}
        <img src="{{ produk.gambar.url }}" class="img-fluid rounded shadow" style="max-height: 400px;" alt="{{ produk.nama }}">
      {% else %}
        <img src="{% static 'img/default-produk.jpg' %}" class="img-fluid rounded shadow" alt="No Image">
      {% endif %}
    </div>

    <!-- TENGAH: Detail -->
    <div class="col-md-5">
      <h4 class="mb-3">{{ produk.nama }}</h4>

      <h6 class="text-muted mb-3">Detail Produk</h6>
      <table class="table table-borderless table-sm mb-4">
        <tr>
          <td style="width: 35%">Kategori</td>
          <td>: {{ produk.kategori.nama }}</td>
        </tr>
        <tr>
          <td>Paket Soal</td>
          <td>: {{ paket_list|length }} Paket</td>
        </tr>
        <tr>
          <td>Total Soal</td>
          <td>: {{ total_soal }} soal</td>
        </tr>
        <tr>
          <td>Dibuat</td>
          <td>: {{ produk.tanggal_dibuat|date:"d M Y" }}</td>
        </tr>
      </table>

      <h6 class="text-muted mb-2">Deskripsi Produk</h6>
      <p class="text-justify">{{ produk.deskripsi|linebreaks }}</p>
    </div>

    <!-- KANAN: Kotak Harga dan Tombol -->
    <div class="col-md-3">
      <div class="card shadow-sm rounded p-3 border-0">
        <h5 class="text-success mb-1">Rp{{ produk.harga|floatformat:0 }}</h5>
        <small class="text-muted">Tersedia untuk dibeli</small>

        <hr>

        <div class="d-flex align-items-center mb-2">
          <i class="fas fa-star text-warning mr-1"></i>
          <span class="text-muted">4.5 â€¢ 123 pembeli</span>
        </div>

        <a href="{% url 'tambah_ke_keranjang' produk.uuid %}" class="btn btn-primary btn-block">ðŸ›’ Beli Produk</a>

        <div class="mt-3 d-flex justify-content-between">
          <a href="#" class="text-secondary small"><i class="far fa-heart"></i> Favorit</a>
          <a href="#" class="text-secondary small"><i class="fas fa-share-alt"></i> Bagikan</a>
        </div>
      </div>
    </div>

  </div>

  <!-- Daftar Paket Soal -->
  <div class="row mt-5">
    <div class="col-md-12">
      <h5>ðŸ“¦ Daftar Paket Soal</h5>
      <ul class="list-group mt-2">
        {% for paket in paket_list %}
          <li class="list-group-item d-flex justify-content-between align-items-center">
            {{ paket.nama }}
            <span class="badge badge-primary badge-pill">{{ paket.soal.count }} soal</span>
          </li>
        {% empty %}
          <li class="list-group-item text-muted">Tidak ada paket soal.</li>
        {% endfor %}
      </ul>
    </div>
  </div>
</div>
{% endblock %}
